# Query an Active Directory Server (General)

Follow the steps to create a Host Discovery query using the Query an Active Directory server
(General) source option. This option scans the default domain controller or a specified server for
all computer objects. The query can be scoped to only return computer objects in specified
containers or individual computer objects. See Step 3 for additional information.

![Host Discovery Wizard Source page for AD General](/img/product_docs/accessanalyzer/admin/hostdiscovery/wizard/source.webp)

**Step 1 –** Open the Host Discovery Wizard. On the Source page, select the **Query an Active
Directory server (General)** option. Click **Next**.

![Host Discovery Wizard Query page for AD General](/img/product_docs/accessanalyzer/admin/datacollector/nis/query.webp)

**Step 2 –** On the Query page, name the query and select the credentials used to access the source.

- Query Name – Provide a unique descriptive name for this query by typing over the `NEWQUERY`
  default name. Two queries cannot have the same name. If you use an existing name, a number is
  automatically appended to the query name, for example `NEWQUERY` becomes `NEWQUERY1`.
- Credentials – Select a Connection Profile. These credentials require the appropriate permissions
  for querying the source:

    - Default credentials (credentials the application is run with) – Applies the credentials used
      to launch the Access Analyzer application
    - Credentials in my default connection profile – Applies the default Connection Profile
      configured at the global level (**Settings** > **Connection**)
    - Credentials in this connection profile – Use the dropdown list to select a Connection Profile
      from those preconfigured at the global level (**Settings** > **Connection**)

    See the [Connection](/docs/accessanalyzer/12.0/admin/settings/connection/overview.md) topic for additional information on
    Connection Profiles.

Click **Next** to continue.

![Host Discovery Wizard Active Directory page](/img/product_docs/accessanalyzer/admin/hostdiscovery/wizard/activedirectory.webp)

**Step 3 –** On the Active Directory page, identify the organizational units (OUs) to scan.

**_RECOMMENDED:_** Scope the query when using this source option.

- Connection – Select the server to connect to and search for computer objects using the radio
  buttons:

    - Connect to default directory – Selects a default domain controller from the domain in which
      the Access Analyzer Console server resides
    - Specify server – Allows you to specify a particular server or domain controller. Type the
      server name in the textbox. Click **Connect** to confirm the connection to the specified
      server and populate the OU choices.

- Use Configuration directory partition (contains all Exchange servers) – If selected, the
  Configuration directory opens in the Selection box
- Selection box – Expand the domain to select containers and individual hosts. Click **Add** to
  include the selected container or host in the OUs to be searched box.
- OUs to be searched box – Displays the selected OUs. Use the buttons at the top of the box to edit
  the list:

    - Add – Adds the selection from the Selection Box into the list
    - Remove – Removes the selected OU from the list

- Search sub-OUs – This checkbox in the OUs to be searched box indicates scan depth for the selected
  OU

Click **Next** to continue.

![Host Discovery Wizard Options page for AD General](/img/product_docs/accessanalyzer/install/application/options.webp)

**Step 4 –** On the Options page, configure the query options as required.

- Run the query when jobs that reference it are run – Select this option to automatically execute
  the Host Discovery query prior to executing a job that has the host list generated by this query
  assigned. This ensures any new hosts have been discovered and are available for auditing.

    **_RECOMMENDED:_** Use this setting only for host lists tied to specific jobs that require
    up-to-date host lists.

- Query Result Retention – Select how to maintain the host list generated by this discovery query:

    - Yes, grow the host list by appending newly discovered hosts – The host list includes every
      host the query has ever discovered
    - No, only show hosts that were found during the most recent run – The host list generated by
      this query includes only hosts found in the most recent query execution. This option removes
      hosts from the generated host list, but does not remove hosts from the Host Master Table.

Click **Next** to continue.

![Host Discovery Wizard Inventory page for AD General](/img/product_docs/accessanalyzer/admin/hostdiscovery/wizard/inventory.webp)

**Step 5 –** On the Inventory page, the host inventory process can be automatically included with
the discovery query.

- Refresh inventory every time when the host discovery query completes – Automates the host
  inventory process and is dependent on the **Settings** > **Host Inventory** node configuration for
  the age of previously inventoried records. Leaving this option deselected applies the global
  settings for host inventory.
- Credentials – Select a Connection Profile. These credentials require the appropriate permissions
  for gathering inventory information from the discovered hosts:

    - Default credentials (credentials the application is run with) – Applies the credentials used
      to launch the Access Analyzer application
    - Credentials in my default connection profile – Applies the default Connection Profile
      configured at the global level (**Settings** > **Connection**)
    - Credentials in this connection profile – Use the dropdown list to select a Connection Profile
      from those preconfigured at the global level (**Settings** > **Connection**)

    See the [Connection](/docs/accessanalyzer/12.0/admin/settings/connection/overview.md) topic for additional information on
    Connection Profiles.

Click **Next** to continue.

![Host Discovery Wizard Summary page for AD General](/img/product_docs/accessanalyzer/admin/datacollector/adinventory/summary.webp)

**Step 6 –** The Summary page displays all the selected query configuration settings. To make
changes, click **Back** to navigate to the relevant wizard page. Click Finish to complete the
configuration process.

![Confirm dialog box](/img/product_docs/accessanalyzer/admin/hostdiscovery/wizard/wizardconfirmdialog.webp)

**Step 7 –** A Confirm dialog box opens. Click **Yes** to run the query now or **No** to run the
query at another time.

Both options close the Host Discovery Wizard and return to the Host Discovery Queries view on the
Host Discovery node. If **Yes** is selected, the **Query State** indicates the running query.
