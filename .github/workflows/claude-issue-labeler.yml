name: Claude Issue Labeler

on:
  issues:
    types: []  # Disabled - replaced by claude-issue-processor.yml

jobs:
  label-issue:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      issues: write
      id-token: write

    steps:
      - name: Checkout repository (Metadata only)
        uses: actions/checkout@v4
        with:
          sparse-checkout: |
            .github
          sparse-checkout-cone-mode: false
      - name: Run Claude Issue Labeler
        id: claude-labeler
        uses: anthropics/claude-code-action@v1
        with:
          anthropic_api_key: ${{ secrets.ANTHROPIC_API_KEY }}
          github_token: ${{ secrets.GITHUB_TOKEN }}
          prompt: |
            REPO: ${{ github.repository }}
            ISSUE NUMBER: ${{ github.event.issue.number }}

            A new issue has been created. Your task is to:
            1. Read the issue using `gh issue view`
            2. Get the list of available labels that start with "AI:" using `gh label list --search "AI:"`
            3. Assign the ONE most relevant "AI:" label to this issue using `gh issue edit`

            Choose only the single most appropriate label from the "AI:" labels based on the issue content.
            If no "AI:" labels are a good fit, do not assign any label.

          claude_args: '--allowed-tools "Bash(gh issue view:*),Bash(gh issue edit:*),Bash(gh label list:*)"'
